<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>命令模式</title>
</head>
<body>
    <button id="button1">点击按钮1</button>
    <button id="button2">点击按钮2</button>
    <button id="button3">点击按钮3</button>
    <script>
        var button1=document.getElementById('button1');
        var button2=document.getElementById('button2');
        var button3=document.getElementById('button3');
        /* *************下面是面向对象的方法来实现************* */
        /* 
        *setcommand负责往按钮上安装命令
        */
        let setcommand=function(button,command){
            button.onclick=function(){
                command.execute();
            }
        };

        /* 
        *各个模块具体的实现
         */
        let menuBar={
            refresh:function(){
                alert('refresh menu The lists');
            }
        };
        let subMenu={
            add:function(){
                alert('add subMenu lists');
            },
            del:function(){
                alert('delete subMenu lists');
            }
        };
        /* 
        *行为的封装
        */
        /* refresh */
        let refreshMenuBarCommand=function(receiver){
            this.receiver=receiver;
        };
        refreshMenuBarCommand.prototype.execute=function(){
            this.receiver.refresh();
        };
        /* add */
        let addSubMenuCommand=function(receiver){
            this.receiver=receiver;
        };
        addSubMenuCommand.prototype.execute=function(){
            this.receiver.add();
        };
        /* del */
        let delSubMenuCommand=function(receiver){
            this.receiver=receiver;
        };
        delSubMenuCommand.prototype.execute=function(){
            this.receiver.del();
        };
        /* 创造实例 */
        let RefreshMenuBarCommand=new refreshMenuBarCommand(menuBar);
        let AddSubMenuCommand=new addSubMenuCommand(subMenu);
        let DelSubMenuCommand=new delSubMenuCommand(subMenu);
        setcommand(button1,RefreshMenuBarCommand);
        setcommand(button2,AddSubMenuCommand);
        setcommand(button3,DelSubMenuCommand);

        /* ********************通过闭包来实现js的命令模式*************************** */
        let setCommandNew=function(button,func){
            button.onclick=function(){
                func();
            }
        };
        let MenuBarNew={
            refresh:function(){
                alert('通过闭包来实现js命令模式的刷新菜单界面');
            }
        }
        let RefreshMenuBarCommandNew=function(receiver){
            return function(){
                receiver.refresh();
            }
        };
        let refreshMenuBarCommandNew=RefreshMenuBarCommandNew(MenuBarNew);
        setCommandNew(button1,refreshMenuBarCommandNew);

        /*把执行操作改为调用execute方法，方便后续添加取消命令等操作  */
        let RefreshMenuBarCommandBetter=function(receiver){
            return {
                execute:function(){
                    receiver.refresh();
                }
            }
        };
        let setCommandBetter=function(button,command){
            button.onclick=function(){
                command.execute();
            }
        };
        let refreshMenuBarCommandbetter=RefreshMenuBarCommandBetter(MenuBarNew);
        setCommandBetter(button1,refreshMenuBarCommandbetter);
    </script>
</body>
</html>